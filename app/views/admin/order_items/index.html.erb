<div>
  <div class="l-page-header">
    <h1><i class="font-icon" data-icon="&#xe02d;"></i>&nbsp; Sold Items</h1>
    <div class="header-actions">
      <% svg = "<svg class='icon' width='100%' height='100%' viewBox='0 0 513 395' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'>
          <g stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'>
              <path d='M237.816115,36.6541111 L197.922377,78.7431616 L40.4270465,78.7431616 L40.2069509,355.476693 L394.699128,355.818123 L394.730167,236.791553 L432.885715,217.846401 L432.97601,394.066788 L1.31775185,394.255844 L0.753404161,40.1953928 L237.816115,36.6541111 Z M198.023963,198.503381 C144.162619,237.172479 81.6272494,313.940703 81.6272494,313.940703 C81.6272494,313.940703 102.812873,165.934885 179.194502,119.790994 C255.576132,73.6471038 335.724795,78.683905 335.724795,78.683905 L336.478199,0.70516348 L512.255573,119.790991 L336.348399,235.719292 L336.537456,159.834281 C336.537456,159.834281 251.885306,159.834283 198.023963,198.503381 Z'></path>
          </g>
      </svg>" %>

      <%= link_to "#{svg} Export CSV".html_safe, coming_soon_dashboard_path, class: "export todo pull-right" %>
    </div>
  </div>
</div>

<%= form_tag set_status_admin_order_items_path, id: "sold-items" do %>
  <div class="actions">
    <h4>Actions</h4>
    <%= select_tag :delivery_status, options_for_select([['Set Delivery Status', nil]] + OrderItem::DELIVERY_STATUSES.map {|s| [s.titleize, s] }) %>
    <input type="submit" class="btn btn--small" value="Apply Action">
    <span>This will be applied to any selected rows.</span>
  </div>

  <table class="sortable sold-table">
    <thead>
      <tr>
        <th><input class="select-all" type="checkbox"></th>
        <th>Order #</th>
        <th>Seller</th>
        <th>Buyer</th>
        <th>Product</th>
        <th>Qty</th>
        <th>Total</th>
        <th>Delivery</th>
        <th>Buyer $</th>
        <th>Seller $</th>
      </tr>
    </thead>

    <% @order_items.decorate.each do |order_item| %>
    <tr class="<%= cycle "odd", "even" %> sold-item">
      <td><%= check_box_tag "order_item_ids[]", order_item.id %></td>
      <td class="order-number">
        <%= content_tag "span", order_item.placed_at, class: "order-date" %><br>
        <%= link_to order_item.order.order_number, coming_soon_dashboard_path, class: "order-number-bold" %>
      </td>
      <td class="order-seller"><%= link_to order_item.seller_name, [:admin, order_item.product.organization], class: "seller" %></td>
      <td class="order-buyer">
        <%= link_to order_item.order.organization.name, [:admin, order_item.order.organization], class: "buyer" %><br>
        <%= content_tag "span", order_item.order.market.name, class: "market" %>
      </td>
      <td class="order-product"><%= link_to order_item.name, [:admin, order_item.product], class: "product" %></td>
      <td class="quantity"><%= order_item.quantity %></td>
      <td class="order-total-price">
        <%= content_tag "span", number_to_currency(order_item.gross_total), class: "total-price" %><br>
        <%= content_tag "span", order_item.price_per_unit, class: "unit-price" %>
      </td>
      <td class="delivery-status"><%= order_item.delivery_status.titleize %></td>
      <td class="buyer-payment-status"><%= order_item.order.payment_status.titleize %></td>
      <td class="seller-payment-status">Unpaid (WIP)</td>
    </tr>
    <% end %>
  </table>
<% end %>

<%= paginate @order_items %>
