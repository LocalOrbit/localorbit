
KnockoutModules.register "download_packing_labels",
  viewModel: (ko,el) ->
    PdfUriPoller.viewModel(ko,el)

$("#print-btn").click (e) ->
  zpl = $("#print-btn").data('zpl')
  qz.websocket.connect().then(->
    qz.printers.find ''
  # Pass the printer name into the next Promise
  ).then((printer) ->
    config = qz.configs.create(printer)
    # Create a default config for the found printer
    data = zpl
    data.forEach (s) ->
      qz.print config, s
  ).catch (e) ->
    console.error e
    return